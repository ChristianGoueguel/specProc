% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/poisson_scale.R
\name{poisson_scale}
\alias{poisson_scale}
\title{Poisson Scaling with Scaling Offset}
\usage{
poisson_scale(x, sc = NULL, drop.na = TRUE, options = list())
}
\arguments{
\item{x}{A numeric matrix or data frame.}

\item{sc}{A vector of previously calculated scales. If provided, these scales
will be applied to the data.}

\item{drop.na}{A logical value indicating whether to remove missing values
(NA) from the calculations. If \code{TRUE} (the default), missing values will be
removed. If \code{FALSE}, missing values will be included.}

\item{options}{A list of options for Poisson scaling. See the 'Options' section below.}
}
\value{
If \code{sc} is not provided, the function returns a list with the following components:
\item{\code{xs}}{The Poisson-scaled data.}
\item{\code{sc}}{A vector of scales calculated for the given data.}

If \code{sc} is provided, the function returns the Poisson-scaled data \code{xs}.
}
\description{
This function performs Poisson scaling on a numeric matrix or data frame.
Poisson scaling scales each variable by its square root mean value,
with an optional scaling offset to avoid over-scaling when a variable has a
near-zero mean.
}
\section{Options}{

The \code{options} argument is a list with the following fields:
\itemize{
\item \code{offset}: A numeric value representing the percentage of the maximum mean value to be used as an offset on all scales. Avoids division by near-zero means. Default is 3.
\item \code{mode}: An integer value (1 or 2) specifying the dimension of the data on which to calculate the mean value for scaling. 1 = mean over rows (to scale variables); 2 = mean over columns (to scale samples). Default is 1.
}
}

\author{
Christian L. Goueguel
}
