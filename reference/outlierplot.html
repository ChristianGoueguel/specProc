<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function creates a visual representation of multivariate outliers using
a univariate plot.It uses robust covariance estimation methods to identify
outliers and provides options for displaying the results through various
plotting styles."><title>Univariate Representation of Multivariate Outliers — outlierplot • specProc</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Univariate Representation of Multivariate Outliers — outlierplot"><meta property="og:description" content="This function creates a visual representation of multivariate outliers using
a univariate plot.It uses robust covariance estimation methods to identify
outliers and provides options for displaying the results through various
plotting styles."><meta property="og:image" content="https://christiangoueguel.github.io/specProc/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">specProc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ChristianGoueguel/specProc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Univariate Representation of Multivariate Outliers</h1>
      <small class="dont-index">Source: <a href="https://github.com/ChristianGoueguel/specProc/blob/HEAD/R/outlierplot.R" class="external-link"><code>R/outlierplot.R</code></a></small>
      <div class="d-none name"><code>outlierplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a visual representation of multivariate outliers using
a univariate plot.It uses robust covariance estimation methods to identify
outliers and provides options for displaying the results through various
plotting styles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">outlierplot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  quan <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  show.outlier <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show.mahal <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A matrix or data frame.</p></dd>


<dt>quan</dt>
<dd><p>A numeric value, between 0.5 and 1, that specifies the amount of observations which are used for MCD estimations. Default is 0.5.</p></dd>


<dt>alpha</dt>
<dd><p>A numeric value specifying the amount of observations used for calculating the adjusted quantile. Default is 0.025.</p></dd>


<dt>show.outlier</dt>
<dd><p>A logical value, if <code>TRUE</code> (default), outliers are highlighted in the plot.</p></dd>


<dt>show.mahal</dt>
<dd><p>A logical value, if <code>FALSE</code> (default), robust Mahalanobis distances are not color-coded in the plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Depending on the combination of <code>show.outlier</code> and <code>show.mahal</code>:</p><ul><li><p>A <code>ggplot</code> object with outliers highlighted (if <code>show.outlier = TRUE</code>)</p></li>
<li><p>A <code>ggplot</code> object with Mahalanobis distances color-coded (if <code>show.mahal = TRUE</code>)</p></li>
<li><p>A <code>ggplot</code> object combining both outlier highlighting and Mahalanobis distance color-coding
(if both <code>show.outlier</code> and <code>show.mahal</code> are <code>TRUE</code>)</p></li>
<li><p>A tibble containing standardized scores, outlier flags, and robust multivariate Mahalanobis distances
(if both <code>show.outlier</code> and <code>show.mahal</code> are <code>FALSE</code>)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses the Minimum Covariance Determinant (MCD) method to compute robust estimates
of location and scatter. It then applies an adaptive reweighting step to further improve
the outlier detection. The results are visualized using <code>ggplot2</code>, with options to highlight
outliers and/or color-code points based on their Mahalanobis distances.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christian L. Goueguel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the glass dataset from the chemometrics package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glass</span>, package <span class="op">=</span> <span class="st">"chemometrics"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage with default parameters</span></span></span>
<span class="r-in"><span><span class="fu">outlierplot</span><span class="op">(</span><span class="va">glass</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="outlierplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adjust the proportion of observations used for MCD estimation</span></span></span>
<span class="r-in"><span><span class="fu">outlierplot</span><span class="op">(</span><span class="va">glass</span>, quan <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="outlierplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show Mahalanobis distances instead of outlier highlighting</span></span></span>
<span class="r-in"><span><span class="fu">outlierplot</span><span class="op">(</span><span class="va">glass</span>, show.outlier <span class="op">=</span> <span class="cn">FALSE</span>, show.mahal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="outlierplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine outlier highlighting and Mahalanobis distance color-coding</span></span></span>
<span class="r-in"><span><span class="fu">outlierplot</span><span class="op">(</span><span class="va">glass</span>, show.outlier <span class="op">=</span> <span class="cn">TRUE</span>, show.mahal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="outlierplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return data frame instead of plot</span></span></span>
<span class="r-in"><span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu">outlierplot</span><span class="op">(</span><span class="va">glass</span>, show.outlier <span class="op">=</span> <span class="cn">FALSE</span>, show.mahal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result_df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 15</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Na2O     MgO  Al2O3    SiO2  P2O5    SO3    Cl   K2O    CaO    MnO   Fe2O3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.382</span>  0.026<span style="text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.993</span>  0.123   7.51 -<span style="color: #BB0000;">1.82</span>   2.45 -<span style="color: #BB0000;">1.36</span>  0.695  1.52  -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.195</span> -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">1.00</span>  -<span style="color: #BB0000;">0.075</span><span style="color: #BB0000; text-decoration: underline;">7</span>  8.17 -<span style="color: #BB0000;">2.24</span>   2.69 -<span style="color: #BB0000;">1.15</span>  0.637  1.66  -<span style="color: #BB0000;">0.379</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  0.111  1.20   -<span style="color: #BB0000;">0.721</span> -<span style="color: #BB0000;">1.20</span>    8.78 -<span style="color: #BB0000;">1.64</span>   2.04 -<span style="color: #BB0000;">1.49</span>  1.60   4.95   0.384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  0.196  0.341  -<span style="color: #BB0000;">0.597</span> -<span style="color: #BB0000;">1.04</span>   11.4  -<span style="color: #BB0000;">0.883</span>  2.87 -<span style="color: #BB0000;">1.46</span>  1.50   3.36   0.777 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.269</span>  0.378  -<span style="color: #BB0000;">2.30</span>   0.421   5.06 -<span style="color: #BB0000;">1.55</span>   2.69 -<span style="color: #BB0000;">1.74</span>  0.705 -<span style="color: #BB0000;">0.690</span> -<span style="color: #BB0000;">1.50</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">0.577</span> -<span style="color: #BB0000;">0.860</span>   2.81   0.673   5.25 -<span style="color: #BB0000;">2.03</span>   2.22 -<span style="color: #BB0000;">1.27</span> -<span style="color: #BB0000;">0.337</span>  4.52   3.36  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: BaO &lt;dbl&gt;, PbO &lt;dbl&gt;, outlier &lt;lgl&gt;, mahalanobis &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian L. Goueguel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

